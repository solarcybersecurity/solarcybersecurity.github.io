<html>

<head>
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-4068332-3"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-4068332-3');
    </script>

    <meta content="text/html; charset=UTF-8" http-equiv="content-type">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body class="c13">
    <h1 class="c12" id="h.ezlccyesa04d"><span class="c5">Disclosure of security vulnerability in Sungrow SH5k-20 Residential Hybrid Inverters - Public disclosure.</span></h1>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c14">2020-03-03 update: </span></p>
    <br>
    <p class="c0"><span class="c7">Sungrow have released a firmware update to mitigate the vulnerabilities described below. Please ensure your Solarinfo dongle is updated to at least version M_WIFI_RAK475_V25_V01_C. This will change the SSID and enable a password on the hotspot. If you don't want to wait for the automatic OTA update you can update your Solarinfo dongle manually via the iSolarHome app. Sungrow have released a video demonstrating the process <a href = "https://youtu.be/hLXRGngH6G4">here.</a> A PDF of the instructions is available <a href = "https://service.sungrowpower.com.au/files/Web_Files/FAQ/Monitoring/GD_201906_All_Local%20Firmware%20Upgrade%20via%20iSolarCloud_V1.0%20%281%29.pdf">here.</a></span></p>
    <br>
    <p class="c0"><span class="c7">On 2020-01-29 a representative from Sungrow Power Australia contacted me via telephone and we discussed the circumstances surrounding the disclosures. There were some misunderstandings about my motivations, but they were dealt with and the representative offered me the opportunity to test a firmware update to the Solarinfo dongle on my own system. I agreed and a few days later I received instructions. I performed the testing and submitted a report. On 2020-02-10 Sungrow provided me a cash award to the value of my Sungrow SH5k-20 inverter: AUD$1950. This award was a once-off payment and Sungrow do not currently operate a bug bounty program.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c14">Note: This is a summarised version of the disclosures sent to Sungrow Australia on 2019-09-20 and 2019-09-22. Specific passwords and protocols have been removed.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <br>
    <p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 236.00px; height: 247.00px;"><img alt="" src="images/image4.png" style="width: 236.00px; height: 247.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p>
    <br>
    <p class="c0"><span class="c7">The Sungrow SH5k-20 is a solar inverter installed as a part of a solar and battery system. It typically connects together solar panels, batteries, a house and the electricity grid and transfers power between them as required. Many of these units have been installed throughout Australia. These systems are also available in other parts of the world.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <br>
    <p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 173.00px; height: 223.00px;"><img alt="" src="images/image3.png" style="width: 173.00px; height: 223.00px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p>
    <br>
    <p class="c0"><span class="c7">These systems are typically equipped with a Sungrow SolarInfo WiFi dongle to enable the smart features of the inverter. The system installer, in consultation with their customer, configures the dongle to connect to the customer&rsquo;s private home WiFi network. With internet access the inverter can now transmit data to Sungrow&rsquo;s monitoring system. Customers can log in via a web page or smartphone app to see the status of their system and historical data.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <br>
    <p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 377.50px; height: 542.80px;"><img alt="" src="images/image1.png" style="width: 377.50px; height: 542.80px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p>
    <br>
    <p class="c3"><span class="c7">Example of the data available on the iSolarCloud smartphone app.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">Consumers can also connect directly to their inverters by connecting to a WiFi Access Point (AP) that the dongle broadcasts with a distinctive name with the format &ldquo;SG-###########&rdquo;, where the hashes (#) represent the inverter&rsquo;s serial number. No password is required to connect to this AP. Once connected, the iSolarCloud smartphone app can be used to provide a username and password to access the inverter statistics. Once logged in a consumer can monitor their solar storage system without an internet connection. The range on this access point is reported to be up to 150 meters in open air. It is at least 10 meters through walls. Consumers cannot set a password on this access point.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">In a cursory survey of two residential suburbs of Brisbane, covering approximately 22km of street, 22 susceptible access points were discovered. These were found by running an access point discovery smartphone app while driving on public roads.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">Packet loggers are a type of software that enable the capture of low level &ldquo;packets&rdquo; of data transmitted to or from a device over its network connections. Sensitive information like usernames and passwords can be extracted from this data. Well-designed security measures can protect this private information during transmission.</span></p>
    <h2 class="c10" id="h.3cgr4gcqcg2b"><span class="c9">Vulnerability</span></h2>
    <p class="c0"><span class="c7">The user-level credentials used to connect from the iSolarCloud smartphone app to the SolarInfo WiFi dongle are public information. It is possible to use a network packet capture tool, running on an unmodified Android smartphone, to record the data exchanged between the inverter and the smartphone during this connection process.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">Contained within this information are numerous sensitive pieces of data, including:</span></p><br>
    <ul class="c11 lst-kix_keoz1yhpoynx-0 start">
        <li class="c0 c6"><span class="c7">The elevated installer-level login credentials,</span></li>
        <li class="c0 c6"><span class="c7">A hidden web interface password,</span></li>
        <li class="c0 c6"><span class="c7">The customer&rsquo;s WiFi access point password, and</span></li>
        <li class="c0 c6"><span class="c7">The protocol used by the smartphone app to change the configuration of the inverter.</span></li>
    </ul>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">&nbsp;The inverter passwords used are short and do not differ between units. The network protocols used to configure the wifi connection and inverter settings are unencrypted, designed for use over closed industrial networks, not public WiFi connections.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">Once an attacker has collected the elevated installer-level and hidden web interface passwords from one Sungrow SH5k-20 unit they may re-use that information in attacks against other units of the same model. This can be done in a few seconds from inside a car parked on the street outside a home equipped with one of these inverters.</span></p>
    <h3 class="c4" id="h.hqxnpsakdd2h"><span class="c2">Attack 1: WiFi password theft</span></h3>
    <p class="c0"><span class="c7">An attacker can read a customer&rsquo;s WiFi access credentials from the SolarInfo wifi dongle. They can then use this information to connect to the customer&rsquo;s home WiFi network. This exposes networked equipment such as printers, cameras, baby monitors, TVs, intercoms, and other smart home devices to attack.</span></p>
    <h3 class="c4" id="h.4rhkygjui0ki"><span class="c2">Attack 2: Battery damage</span></h3>
    <p class="c0"><span class="c7">An attacker has access to battery settings intended for use by qualified service and installation personnel. These settings can be accessed via the installer-level login credentials in the iSolarCloud smartphone app, or via a direct connection to the inverter using an unencrypted industrial protocol. These settings include maximum battery voltage, temperature and discharge current. Intentional misconfiguration of these settings could lead to:</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <ul class="c11 lst-kix_urjdtkxu317q-0 start">
        <li class="c0 c6"><span class="c7">Blackouts,</span></li>
        <li class="c0 c6"><span class="c7">Grid power interference,</span></li>
        <li class="c0 c6"><span class="c7">Increased degradation of battery capacity,</span></li>
        <li class="c0 c6"><span class="c7">Excess power consumption,</span></li>
        <li class="c0 c6"><span class="c7">Energising &nbsp;the power grid during scheduled outages for maintenance,</span></li>
        <li class="c0 c6"><span class="c7">Battery explosion and fire.</span></li><br>
    </ul>
    <p class="c3"><span style="overflow: hidden; display: inline-block; margin: 0.00px 0.00px; border: 0.00px solid #000000; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px); width: 294.25px; height: 605.50px;"><img alt="" src="images/image2.png" style="width: 294.25px; height: 605.50px; margin-left: 0.00px; margin-top: 0.00px; transform: rotate(0.00rad) translateZ(0px); -webkit-transform: rotate(0.00rad) translateZ(0px);" title=""></span></p>
    <p class="c3"><span>Some of the settings available in the inverter.</span></p>
    <h3 class="c4" id="h.ar9jwon2oymy"><span class="c2">Attack 3: Man-in-the-middle</span></h3>
    <p class="c0"><span>The inverter communicates to Sungrow&rsquo;s internet servers using an unencrypted and unauthenticated Internet of Things (IoT) protocol. It would be possible for a hostile actor to imitate this server, or otherwise inject messages, and send arbitrary commands to the inverter.</span>
        <hr style="page-break-before:always;display:none;">
    </p>
    <h2 class="c10" id="h.5ggeb1q25n39"><span class="c9">Suggested Immediate steps</span></h2>
    <h3 class="c4" id="h.grdq3pq4v7s3"><span class="c8">Users</span></h3>
    <p class="c0"><span class="c7">Unscrew the two bolts attaching the Sungrow WiFi dongle from the bottom of your inverter with a phillips-head screwdriver. Pull the WiFi dongle straight down. Put a piece of tape over the port to keep out dust and insects. Do not connect an ethernet connection to this port. It may cause damage to the inverter or your network equipment. There is an ethernet connection inside the inverter housing, but it should only be connected by qualified personnel. Contact the installer of your solar storage system for the next steps.</span></p>
    <h3 class="c4" id="h.53vkvmd1h2ze"><span class="c8">Suppliers/Installers</span></h3>
    <p class="c0"><span class="c7">Halt sale and installation of the Sungrow SolarInfo WiFi dongle. Notify previous customers of these vulnerabilities. Contact Sungrow Australia for further information on rectifying these cybersecurity issues.</span></p>
    <h3 class="c4" id="h.snsinvo7ci71"><span class="c8">Manufacturer</span></h3>
    <p class="c0"><span class="c7">Notify all suppliers/installers of the vulnerabilities and issue a recall of affected hardware. </span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <p class="c0"><span class="c7">Employ industry-standard cybersecurity principals, such as:</span></p><br>
    <ul class="c11 lst-kix_jfk4quu4ej9e-0 start">
        <li class="c0 c6"><span class="c7">Secure signed firmware updates,</span></li>
        <li class="c0 c6"><span class="c7">Use a complex initial password unique to each unit,</span></li>
        <li class="c0 c6"><span class="c7">Encrypt all network communications,</span></li>
        <li class="c0 c6"><span class="c7">Disable the configuration wifi access point once the customer&rsquo;s network has been configured,</span></li>
        <li class="c0 c6"><span class="c7">Employ Over the Air (OtA) updates to rectify security vulnerabilities in installed hardware.</span></li>
    </ul>
    <h2 class="c10" id="h.wgj3ohytwruq"><span class="c9">Responsible disclosure</span></h2>
    <p class="c0"><span class="c7">Details of the vulnerabilities disclosed in this document were provided to Sungrow Australia on 2019-09-20. Every effort was made to assist them in understanding the severity of these issues and the risks to which their customers were exposed. They did not commit to rectifying these issues.</span></p>
    <p class="c0 c1"><span class="c7"></span></p>
    <div>
        <span class="c7">Rev. 3</span></p>
    </div><br>
    <span class="c7"></span><a href = "mailto: solarcyberseccontact@gmail.com">Email: solarcyberseccontact@gmail.com</a></span><br>
    <span class="c7"></span><a href = "https://twitter.com/@solarcybersec">Twitter: @solarcybersecurity</a></span><br>
    <span class="c7"></span><a href = "https://www.reddit.com/user/solarcybersecurity/">Reddit: solarcybersecurity</a></span><br>

</body>

</html>
